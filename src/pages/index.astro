---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import { getCollection } from 'astro:content'; 

const allPosts = await getCollection('posts');

const posts = allPosts.sort((a, b) => {
    const da = a.data.date ? new Date(a.data.date) : new Date(0);
    const db = b.data.date ? new Date(b.data.date) : new Date(0);
    return db.getTime() - da.getTime();
});
---

<BaseLayout title="lc">
  <Header/>
  <main>
    <h1>hello üê¢</h1>
    <p>
      There's a <a href="read-list">list of books I read</a>, a <a href="reading-list">list of things I want to read</a>, a <a href="about-me">list of things I've been up to</a>.
    </p>
    <p>And a list of things I'm learning:</p>

    <ul class="posts">
      {posts.map(post => { 
        const raw = post.data.date; 
        const formatted = raw
          ? new Date(raw).toLocaleDateString(undefined, {day: 'numeric', month: 'short', year: 'numeric' })
          : '';
        
        return (
          <li>
            {raw ? <time class="post-date" datetime={raw.toString()}>{formatted}</time> : <span class="post-date" />}
            <a href={`/posts/${post.slug}`}>{post.data.title}</a>
          </li>
        );
      })}
    </ul>

    <hr class="my-8" />


    </main>
</BaseLayout>

<style>
  .posts { 
    list-style: none; 
    padding: 0; 
    margin: 1rem 0; 
  }
  
  .posts li { 
    display: grid; 
    grid-template-columns: 120px 1fr; 
    align-items: center; 
    gap: 0.6rem; 
    padding: 0.25rem 0; 
  }
  
  .post-date {
    display: block; 
    color: #6b7280; 
    font-size: 0.95rem; 
    text-align: left; 
  }

  .my-8 {
    margin-top: 2rem;
    margin-bottom: 2rem;
    border: 0;
    border-top: 1px solid #eee;
  }
</style>